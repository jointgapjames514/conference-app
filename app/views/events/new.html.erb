<!-- <script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script> -->

<% content_for :head do %>
  <script src="//maps.googleapis.com/maps/api/js?key=AIzaSyCMl4aZmSFX9mACw1GcwGLUriCcIcj9OZM&amp;sensor=false&amp;libraries=places"></script>
<% end %>

<div class="form-group"><h1>Create New Event Group</h1></div>

<%= form_for :event, url: events_path do |f| %>
  <div class="form-group">
	<p>Fields with <span class="asteroid">*</span> are required.</p>
  </div>

  <div class="form-group row">
	<label for="name" class="col-xs-3 col-form-label">Event Name <span class="asteroid">*</span></label>
	<div class="col-xs-6">
	  <%= f.text_field :name, :required => true, :class => 'form-control' %>
	</div>
  </div>

  <div class="form-group row">
	<label for="description" class="col-xs-3 col-form-label">Description <span class="asteroid">*</span></label>
	<div class="col-xs-6">
	  <%= f.text_area :description, :required => true, :class => 'form-control', :rows => 7 %>
	</div>
  </div>

  <div class="form-group row">
	<label for="category_id" class="col-xs-3 col-form-label">Category</label>
	<div class="col-xs-3">
	  <% if @category_types %>
	  <%= f.select :category_id, options_for_select(@category_types.map{ |c| [c.category, c.id] }), {}, {:class => 'form-control'} %>
	  <% else %>
	  <span>Category does not exist.</span>>
	  <% end %>
	</div>
  </div>

  <div class="form-group row">
	<label for="avatar" class="col-xs-3 col-form-label">Event Logo</label>
	<div class="col-xs-6">
      <%= f.file_field :avatar %>
      <%= f.hidden_field :avatar_cache %>
	</div>
  </div>

  <div class="form-group row">
	<label for="timezone" class="col-xs-3 col-form-label">Timezone</label>
	<div class="col-xs-3">
	  <select name="event[timezone]" id="event_timezone" class="form-control"></select>
	</div>
  </div>

  <div class="form-group row">
	<label for="start_date" class="col-xs-3 col-form-label">Start Date <span class="asteroid">*</span></label>
	<div class="col-xs-3">
	  <%= f.text_field :start_date, :required => true, :class => 'form-control' %>
	</div>
  </div>

  <div class="form-group row">
	<label for="end_date" class="col-xs-3 col-form-label">End Date <span class="asteroid">*</span></label>
	<div class="col-xs-3">
	  <%= f.text_field :end_date, :required => true, :class => 'form-control' %>
	</div>
  </div>
  
  <div class="form-group">
  	<%= f.check_box :coming_soon %><span>&nbsp;&nbsp;Would you like your event guide to be listed as "Coming Soon"? Event guides listed as "Coming Soon" appear in the Eventbase app but cannot be downloaded while this option is selected.</span>
  </div>

  <hr>

  <div class="form-group"><h3>Event Location</h3></div>

  <div class="address">
	  <div class="form-group row">
		<label for="address" class="col-xs-3 col-form-label">Address <span class="asteroid">*</span></label>
		<div class="row col-xs-6">
		  <div class="col-xs-10">
		  	<input id="event_address" name="event[address]" type="text" placeholder="Type in an address" value="111 Broadway, New York, NY" class="form-control" required="required" />	
		  </div>
		  
		  <div class="col-xs-2">
		  	<input id="find" type="button" value="Find" class="btn btn-primary" />
		  </div>     
		</div>
	  </div>

	  <div class="map_canvas"></div>

	  <div class="form-group row">
		<label for="lat" class="col-xs-3 col-form-label">Latitude</label>
		<div class="col-xs-3">
		  <input id="lat" name="lat" type="text" value="" class="form-control" disabled="disabled">
		  <input type="hidden" name="event[lat]">
		</div>
	  </div>

	  <div class="form-group row">
		<label for="lng" class="col-xs-3 col-form-label">Longitude</label>
		<div class="col-xs-3">
		  <input id="lng" name="lng" type="text" value="" class="form-control" disabled="disabled">
		  <input type="hidden" name="event[lng]">
		</div>
	  </div>

	  <div class="form-group row">
		<label class="col-xs-3 col-form-label">Formatted Address</label>
		<div class="col-xs-3">
		  <input name="formatted_address" type="text" value="" class="form-control" disabled="disabled">	  
		</div>
		<div class="col-xs-6">
			<a id="reset" href="#" style="display:none;">Reset Marker</a>
		</div>
	  </div>
  </div>

  <hr>

  <div class="form-group">
  	<input type="checkbox" id="extra"><span>&nbsp;&nbsp;Do you need any more fields?</span>
  </div>

  <div class="extra" style="display:none;">
	  <div class="form-group row">
		<label for="extra_name" class="col-xs-3 col-form-label">Extra Field Name <span class="asteroid">*</span></label>
		<div class="col-xs-6">
		  <%= f.text_field :extra_name, :required => true, :class => 'form-control' %>
		</div>
	  </div>

	  <div class="form-group row">
		<label for="extra_desc" class="col-xs-3 col-form-label">Description <span class="asteroid">*</span></label>
		<div class="col-xs-6">
		  <%= f.text_area :extra_desc, :required => true, :class => 'form-control', :rows => 7 %>
		</div>
	  </div>

	  <div class="form-group row">
	  	<div class="col-xs-3">
	  		<input id="event_extra_date_first_name" name="event[extra_date_first_name]" type="text" placeholder="Type first extra date field name" class="form-control" required="required" />
	  	</div>
	  	<div class="col-xs-3">
		  <%= f.text_field :extra_date_first, :required => true, :class => 'form-control' %>
		</div>
	  </div>

	  <div class="form-group row">
	  	<div class="col-xs-3">
	  		<input id="event_extra_date_second_name" name="event[extra_date_second_name]" type="text" placeholder="Type second extra date field name" class="form-control" />
	  	</div>
	  	<div class="col-xs-3">
		  <%= f.text_field :extra_date_second, :class => 'form-control' %>
		</div>
	  </div>		
  </div>
  <hr>

  <%= f.submit "Save New Event", :class => 'btn btn-primary' %>
  
  <%= link_to 'Back', events_path, :class => 'btn btn-warning' %>
<% end %>


<script>
	$(document).ready(function(){
		$('#event_timezone').timezones();
		$('#event_start_date').datepicker();
		$('#event_end_date').datepicker();
		$('#event_extra_date_first').datepicker();
		$('#event_extra_date_second').datepicker();
		
		$("#event_address").geocomplete({
	      map: ".map_canvas",
	      details: ".address",
	      markerOptions: {
	        draggable: true
	      }
	    });
	    
	    $("#event_address").bind("geocode:dragged", function(event, latLng){
	      $("input[name=lat]").val(latLng.lat());
	      $("input[name=lng]").val(latLng.lng());
	      $("#reset").show();
	    });
	    

	    $("#reset").click(function(){
	      $("#event_address").geocomplete("resetMarker");
	      $("#reset").hide();
	      return false;
	    });
	    
	    $("#find").click(function(){
	      $("#event_address").trigger("geocode");
	    }).click();	

	    $("#extra").on('click', function(){
	    	if($(this).prop('checked') == true) 
	    		$('.extra').css('display', 'initial');
	    	else
	    		$('.extra').css('display', 'none');
	    });
	});
	
</script>


